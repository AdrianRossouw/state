<div class="source-content">
  
    
    <div class="text">
      
    </div>
    <div class="code">
      <div class="highlight"><pre><span class="nv">RootState        = </span><span class="kc">null</span>
<span class="nv">StateExpression  = </span><span class="kc">null</span>

<span class="nv">module.exports =</span></pre></div>
    </div>
  
    
    <div class="text">
      
<h2><a href="#state-function">state()</a></h2>
<p>The primary point of entry into the module is to invoke the exported <code>state</code>
function. This is used either to:</p>
<ol>
<li>generate a formal <code>StateExpression</code> object; or</li>
<li>bestow any given <code>owner</code> object with a working state implementation.</li>
</ol>
<h6>PARAMETERS</h6>
<ul>
<li><p>[<code>owner</code>] : object</p>
</li>
<li><p>[<code>attributes</code>] : string — A whitespace-delimited set of attribute keywords.</p>
</li>
<li><p>[<code>expression</code>] : object | <code>StateExpression</code></p>
</li>
<li><p>[<code>options</code>] : object — A map that includes any of the following properties:</p>
<ul>
<li><p><code>name</code> : string — A name to be given to the <strong>accessor</strong> method that will
be added to <code>owner</code>. Defaults to <code>&#39;state&#39;</code>.</p>
</li>
<li><p><code>initial</code> : string — A selector that names a specific <code>State</code>. Providing
this option overrides any <code>initial</code> attributes borne by <code>owner</code>’s states.</p>
</li>
</ul>
</li>
</ul>
<h6>DISCUSSION</h6>
<p>All arguments are optional. If only one <code>object</code>-typed argument is provided,
it is assigned to the <code>expression</code> parameter. If no <code>owner</code> is present,
<code>state()</code> returns a <code>StateExpression</code> based on the contents of <code>expression</code>
(and <code>attributes</code>). If both an <code>owner</code> and <code>expression</code> are present, <code>state()</code>
acts in the second capacity: it causes <code>owner</code> to become stateful, creating a
new <code>RootState</code> (and subordinate state tree) based on <code>expression</code>, and returns
the owner’s initial <code>State</code>.</p>
<p>The <code>attributes</code> argument may include any of the words defined in
<code>STATE_ATTRIBUTE_MODIFIERS</code>, which are encoded into the provided <code>expression</code>.</p>
<h6>SEE ALSO</h6>
<blockquote>
<p><code>STATE_ATTRIBUTES</code></p>
<p><a href="/api/#state-function"><code>state()</code></a>
<a href="/docs/#getting-started--the-state-function">The <code>state</code> function</a></p>
</blockquote>
<h6>SOURCE</h6>

    </div>
    <div class="code">
      <div class="highlight"><pre><span class="nv">state = </span><span class="nf">( owner, attributes, expression, options ) -&gt;</span>
  <span class="k">if</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span> <span class="o">&lt;</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">owner</span> <span class="o">is</span> <span class="s1">&#39;string&#39;</span>
    <span class="k">then</span> <span class="nv">attributes = </span><span class="nx">owner</span>
    <span class="k">else</span> <span class="nv">expression = </span><span class="nx">owner</span>
    <span class="nv">owner = </span><span class="kc">undefined</span>
  <span class="k">else</span>
    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">owner</span> <span class="o">is</span> <span class="s1">&#39;string&#39;</span>
      <span class="nv">options = </span><span class="nx">expression</span>
      <span class="nv">expression = </span><span class="nx">attributes</span>
      <span class="nv">attributes = </span><span class="nx">owner</span>
      <span class="nv">owner = </span><span class="kc">undefined</span>
    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">attributes</span> <span class="o">isnt</span> <span class="s1">&#39;string&#39;</span>
      <span class="nv">options = </span><span class="nx">expression</span>
      <span class="nv">expression = </span><span class="nx">attributes</span>
      <span class="nv">attributes = </span><span class="kc">undefined</span></pre></div>
    </div>
  
    
    <div class="text">
      
<p>Formalize the provided <code>expression</code> (even if <code>expression</code> is already a formal
<code>StateExpression</code>), incorporating any provided <code>attributes</code>.</p>

    </div>
    <div class="code">
      <div class="highlight"><pre>  <span class="nv">expression = </span><span class="k">new</span> <span class="nx">StateExpression</span> <span class="nx">attributes</span><span class="p">,</span> <span class="nx">expression</span></pre></div>
    </div>
  
    
    <div class="text">
      
<p>If <code>owner</code> is absent, the inferred intent is only to return the formalized
<code>expression</code>; otherwise the inference is to implement <code>expression</code> into
<code>owner</code>.</p>

    </div>
    <div class="code">
      <div class="highlight"><pre>  <span class="k">if</span> <span class="nx">owner</span>
    <span class="p">{</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">initial</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">options</span> <span class="k">if</span> <span class="nx">options</span>
    <span class="p">(</span> <span class="k">new</span> <span class="nx">RootState</span> <span class="nx">owner</span><span class="p">,</span> <span class="nx">expression</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">initial</span> <span class="p">).</span><span class="nx">_current</span>
  <span class="k">else</span> <span class="nx">expression</span></pre></div>
    </div>
  
    
    <div class="text">
      
<h3><a href="#state-function--static-includes">Static includes</a></h3>
<p>A set of package-global metadata and functions are included as properties of
the exported <code>state</code> function.</p>
<blockquote>
<p>These must be required ahead of the forward imports.</p>
</blockquote>

    </div>
    <div class="code">
      <div class="highlight"><pre><span class="p">(</span> <span class="nx">require</span> <span class="s1">&#39;./export-static&#39;</span> <span class="p">).</span><span class="nx">apply</span> <span class="nx">state</span></pre></div>
    </div>
  
    
    <div class="text">
      
<h3><a href="#state-function--forward-imports">Forward imports</a></h3>

    </div>
    <div class="code">
      <div class="highlight"><pre><span class="nv">RootState        = </span><span class="nx">require</span> <span class="s1">&#39;./root-state&#39;</span>
<span class="nv">StateExpression  = </span><span class="nx">require</span> <span class="s1">&#39;./state-expression&#39;</span>

</pre></div>
    </div>
  
</div>